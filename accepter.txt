refactor: improve type safety
refactor: simplify complex logic
refactor: improve code reusability
