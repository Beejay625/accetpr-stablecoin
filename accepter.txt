refactor: simplify complex logic
refactor: improve code reusability
